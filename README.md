# PiggyTest

Лучники реализованы с помощью стейт машины которая имеет два основных состояния "айдл" и "шутинг" в шутинг Лучник переходит как только в радиусе колайдера появляется хотя бы одна цель. Цели добавляются в колекцию очереди и из неё лучники выбирают какую следующую цель стрелять, они не прекращают стрелять пока очередь не опустеет (либо цель была уничтожена либо она сама ушла за пределы радиуса), после чего переходят обратно в айдл состояние. Учитывая что у нас есть отдельно радиус дистанции в которой лучник реагирует на цель и отдельно скорость стрелы с какой он может её выпускать, может происходить такое что при любых возможных траекториях лучник не может достать до цели хотя она и в радиусе дистанции который мы задали, есть проверка таких исключений, в данном случае лучнику передаётся угол прямо направленный на цель и выводится сообщение в консоль о том что он не может достать до цели.

Проект имеет простую симуляцию ентри поинта (обьект на сцене, не отдельаня сцена, для скорости реализации, так как само тестовое этого не требовало) для удобства, из которого всё запускается, инициализируется, и спавнится. По хорошему все обьекты имеют отдельные методы инициализации для коректной инжекции в них необходимых скриптов, вроде фабрик и пулов, но на случай для дизайнеров и удобства тестинга, реализованы заглужки на случай если брефабы просто закинуты на сцены (тогда создаются новые временные фабрики, пулы, и что еще им может быть нужно которые исчезнут вместе с уничтожением обьектов). Для примера я и поставил одного лучника закинутого на сцену таким образом, а второй спавнится полноценно из ентрипоинта с прокидыванием всех зависимостей (ровно по центру).
В текущих условиях не было оговорены детали прицеливания и целей, то есть могут ли враги двигатся и нужно ли будет при этом вести прицел за ними или стрелять на упреждение, поэтому в выгоды скорости и "не делать того чего не просили" оставил вариант из скинутого примера -
то есть цели спавнятся однажды и статичны (вызывается ивент на прицеливание один раз), но архетектура реализована так что бы в любой момент можно было добавить эти механики просто перенеся их в метод апдейт стейта шутинга у лучников (Туда же можно засунуть
и плавный поворот свиньи на цель вместо резкого, который будет зависить от времени длительности анимации деленую на её скорость, что бы поворот всегда успевал вовремя завершится).

Так же основываясь на имеющейся информации из задания было выбрано очевидное предпочтение композиции вместо наследования при создании класса стрелл (елси всё таки действительно в реальной задаче на проекте есть другие параметры и методы для стрел которые необходимо
реализовывать возможность пересмотра подхода для удобства не имеет большой проблемы). имеется 4 типа стрел со своими Енамами и уроном, на данный момент вовремя выстрела лучники запрашивают рандомную стрелу из пула (фабрики если пул пуст), каждый тип стрел имеет свою очередь в пуле (дикшионари по типу).

Спавнер спавнет врагов в рандомной точке внутри своих границ которые задаются из инспектора. У врагов есть скрипт самоудаления через определнный промежуток времени (тоже задаётся из скрипта). При попадании стрел во врага, враг вызывает метод ExecuteHitEction(int damage)
который является реализацией интерфейса "ITargetable" в метод передаются данные об уроне из стрелы (которая в свою очередь берется из обькта колизии). Метод сообщает о том сколько он получил урона в консоль.
